<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SquareRoot Calculator</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="src/bootstrap/css/bootstrap.min.css">
    <script src="src/bootstrap/js/bootstrap.min.js"></script>
    <!-- // Bootstrap -->

    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>

    <div class="base">
        <div class="screen">
            <label for="paramInicial" class="label-paramInicial">Calcular raiz quadrada de:</label>
            <div class="input-group">
                <input type="number" class="form-control" aria-describedby="butn-calcular" id="paramInicial" name="paramInicial">
                <button class="btn btn-outline-secondary" type="button" id="btn-calcular" onclick="btnCalcular()" data-bs-toggle="modal" data-bs-target="#squareRootModal">Calcular</button>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="squareRootModal" tabindex="-1" aria-labelledby="squareRootModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body squareroot-space" id="squareroot-space" style="margin: auto;">
                    
                    

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Voltar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const isInteger = (param) => !isNaN(param.replace('.', 'a')) && param.trim().length > 0

        function btnCalcular(){
            let parametroInicial = "36" //document.querySelector('#paramInicial').value
            console.log(parametroInicial)

            if(isInteger(parametroInicial)){
                
                
                const squarerootResult = squarerootCalculator(parametroInicial)
                console.log(squarerootResult)
                let squarerootContent = ""

                if(squarerootResult.raizJaSimplificada){

                    squarerootContent += '<p class="aviso">Essa raiz já está simplificada</p>'
                    squarerootContent += '<p>√'+parametroInicial+' = '+squarerootResult.valorDecimalStr+'</p>'

                } else {
                    // Inicio
                    squarerootContent += '<p>√('+parametroInicial+')</p>'

                    // Fatoração
                    squarerootContent += '<div class="fatoracao-table"><table>'
                    squarerootResult.fatoracao.dividendos.map((num, index) => {
                        squarerootContent += '<tr><td class="dividendo">'+squarerootResult.fatoracao.dividendos[index]+'</td><td class="divisor">'+squarerootResult.fatoracao.divisores[index]+'</td></tr>'
                    })
                    squarerootContent += '</table></div>'


                    // separa os pares da fatoração em potências de 2
                    squarerootContent += "<p>√("
                    for(const num in squarerootResult.numerosForaDaRaiz){
                        squarerootContent += squarerootResult.numerosForaDaRaiz[num]+"²"
                        if(num < squarerootResult.numerosForaDaRaiz.length-1){
                            squarerootContent += " × "
                        }
                    }
                    if(squarerootResult.numerosDentroDaRaiz.length > 0) squarerootContent += " × "
                    for(const num in squarerootResult.numerosDentroDaRaiz){
                        squarerootContent += squarerootResult.numerosDentroDaRaiz[num]
                        if(num < squarerootResult.numerosDentroDaRaiz.length-1){
                            squarerootContent += " × "
                        }
                    }
                    squarerootContent += ")"

                    // Tira as potencias de dentro da raiz
                    squarerootContent += "<p>"
                    for(const num in squarerootResult.numerosForaDaRaiz){
                        squarerootContent += squarerootResult.numerosForaDaRaiz[num]
                        if(num < squarerootResult.numerosForaDaRaiz.length-1){
                            squarerootContent += " × "
                        }
                    }
                    if(squarerootResult.numerosDentroDaRaiz.length > 0){
                        squarerootContent += " × √("
                        for(const num in squarerootResult.numerosDentroDaRaiz){
                            squarerootContent += squarerootResult.numerosDentroDaRaiz[num]
                            if(num < squarerootResult.numerosDentroDaRaiz.length-1){
                                squarerootContent += " × "
                            }
                        }
                        squarerootContent += ")"
                    }

                    // Efetua as multiplicações
                    if(squarerootResult.numerosForaDaRaiz.length + squarerootResult.numerosDentroDaRaiz.length > 1){
                        squarerootContent += "<p>"+squarerootResult.resultadoFinalStr+"</p>"
                    }
                }

                document.querySelector('#squareroot-space').innerHTML = squarerootContent

            } else {
                console.log("isn't Integer")
            }
        }
    </script>

    <script src="src/scripts/squarerootCalculator.js"></script>
</body>
</html>